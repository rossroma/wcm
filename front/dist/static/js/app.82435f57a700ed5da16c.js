webpackJsonp([1],{KK7s:function(t,e){},NHnr:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=a("7+uW"),i=(a("tvR6"),{render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"app",attrs:{id:"app"}},[e("router-view")],1)},staticRenderFns:[]});var s=a("VU/8")(null,i,!1,function(t){a("hjMK")},null,null).exports,o=a("zL8q"),r=a.n(o),l=a("/ocq"),c=a("//Fk"),u=a.n(c),m=a("mtWM"),d=a.n(m),f=function(t,e){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"post";return new u.a(function(n,i){d.a[a]("/"+t,e).then(function(t){n(t.data),1===t.data.code?n(t.data):(Object(o.Message)({type:"error",message:t.data.msg}),i(t.data))})})},p=a("woOf"),h=a.n(p),v={userName:"",date1:"",time1:"",date2:"",time2:""},_={props:{item:{type:Object,required:!0}},data:function(){return{dialogVisible:!0,form:{},rules:{userName:[{required:!0,message:"请输入姓名",trigger:"blur"},{min:2,max:4,message:"长度在 3 到 4 个字符",trigger:"blur"}],date1:{required:!0,message:"请选择开井日期",trigger:"change"},time1:{required:!0,message:"请选择开井时间",trigger:"change"},date2:{required:!0,message:"请选择关井日期",trigger:"change"},time2:{required:!0,message:"请选择关井时间",trigger:"change"}},pickerOptions:{disabledDate:function(t){return t.getTime()>Date.now()},shortcuts:[{text:"今天",onClick:function(t){t.$emit("pick",new Date)}},{text:"昨天",onClick:function(t){var e=new Date;e.setTime(e.getTime()-864e5),t.$emit("pick",e)}},{text:"前天",onClick:function(t){var e=new Date;e.setTime(e.getTime()-1728e5),t.$emit("pick",e)}}]},formatData:{userName:"",startTime:"",endTime:"",period:"",cost:""},editStatus:!0,loading:!1}},computed:{dialogTitle:function(){return this.form.id?"修改记录":"新增记录"}},created:function(){this.item.id?this.initItem():this.form=h()({},v)},methods:{initItem:function(){var t=h()({},this.item);this.form={id:t.id,userName:t.userName,date1:t.startTime.slice(0,10),time1:t.startTime.slice(11),date2:t.endTime.slice(0,10),time2:t.endTime.slice(11)}},trimValue:function(t){this.form.userName=this.form.userName.trim()},handleStartDate:function(t){this.$set(this.form,"date2",t)},handleSubmit:function(t){var e=this;this.$refs[t].validate(function(t){if(!t)return!1;e.beforeSave(e.form)})},beforeSave:function(t){var e=h()({},t),a=e.date1+" "+e.time1,n=e.date2+" "+e.time2,i=(new Date(n).getTime()-new Date(a).getTime())/1e3/60,s=Number((.9*i).toFixed(2));return i<=0?(this.$notify({title:"警告",message:"关井时间不能在开井时间之前！",type:"error"}),!1):i>1440?(this.$notify({title:"警告",message:"灌溉时间超过24小时，请检查是否输入正确！",type:"error"}),!1):(this.formatData={userName:e.userName,startTime:a,endTime:n,period:i,cost:s},void this.saveData(this.formatData))},saveData:function(t){var e=this;this.loading=!0;var a={id:this.form.id||0,data:t};f("Item.html",a).then(function(t){e.$message({type:"success",message:t.msg}),e.$set(e.form,"id",t.id),e.editStatus=!1,e.$emit("refresh"),e.loading=!1}).then(function(){e.loading=!1})},continueAdd:function(){var t=h()({},v);t.date1=this.form.date2,t.date2=this.form.date2,t.time1=this.form.time2,this.form=t,this.editStatus=!0},closeDialog:function(){this.$emit("close")}},filters:{toHHMM:function(t){return Math.floor(t/60)+"时"+t%60+"分"}}},g={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"edit-wrap"},[a("el-dialog",{attrs:{title:t.dialogTitle,visible:t.dialogVisible,width:"800px","before-close":t.closeDialog},on:{"update:visible":function(e){t.dialogVisible=e}}},[t.editStatus?a("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"form-wrap"},[a("el-form",{ref:"form",attrs:{model:t.form,"label-width":"120px",rules:t.rules}},[a("el-form-item",{attrs:{label:"姓名",prop:"userName"}},[a("el-input",{on:{blur:t.trimValue},model:{value:t.form.userName,callback:function(e){t.$set(t.form,"userName",e)},expression:"form.userName"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"开井时间"}},[a("el-col",{attrs:{span:11}},[a("el-form-item",{attrs:{prop:"date1"}},[a("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"date",placeholder:"选择日期",editable:!1,"value-format":"yyyy-MM-dd","picker-options":t.pickerOptions},on:{change:t.handleStartDate},model:{value:t.form.date1,callback:function(e){t.$set(t.form,"date1",e)},expression:"form.date1"}})],1)],1),t._v(" "),a("el-col",{staticClass:"line",attrs:{span:2}},[t._v("-")]),t._v(" "),a("el-col",{attrs:{span:11}},[a("el-form-item",{attrs:{prop:"time1"}},[a("el-time-picker",{staticStyle:{width:"100%"},attrs:{type:"fixed-time",placeholder:"选择时间",editable:!1,"value-format":"HH:mm"},model:{value:t.form.time1,callback:function(e){t.$set(t.form,"time1",e)},expression:"form.time1"}})],1)],1)],1),t._v(" "),a("el-form-item",{attrs:{label:"关井时间"}},[a("el-col",{attrs:{span:11}},[a("el-form-item",{attrs:{prop:"date2"}},[a("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"date",placeholder:"选择日期",editable:!1,"value-format":"yyyy-MM-dd","picker-options":t.pickerOptions},model:{value:t.form.date2,callback:function(e){t.$set(t.form,"date2",e)},expression:"form.date2"}})],1)],1),t._v(" "),a("el-col",{staticClass:"line",attrs:{span:2}},[t._v("-")]),t._v(" "),a("el-col",{attrs:{span:11}},[a("el-form-item",{attrs:{prop:"time2"}},[a("el-time-picker",{staticStyle:{width:"100%"},attrs:{type:"fixed-time",placeholder:"选择时间",editable:!1,"value-format":"HH:mm"},model:{value:t.form.time2,callback:function(e){t.$set(t.form,"time2",e)},expression:"form.time2"}})],1)],1)],1)],1)],1):a("table",{staticClass:"table-list"},[a("tr",{staticClass:"row thead"},[a("th",{staticClass:"col"},[t._v("姓名")]),t._v(" "),a("th",{staticClass:"col"},[t._v("开井时间")]),t._v(" "),a("th",{staticClass:"col"},[t._v("关井时间")]),t._v(" "),a("th",{staticClass:"col"},[t._v("耗时(分钟)")]),t._v(" "),a("th",{staticClass:"col"},[t._v("费用")])]),t._v(" "),a("tr",{staticClass:"row"},[a("td",{staticClass:"col"},[t._v(t._s(t.formatData.userName))]),t._v(" "),a("td",{staticClass:"col"},[t._v(t._s(t.formatData.startTime))]),t._v(" "),a("td",{staticClass:"col"},[t._v(t._s(t.formatData.endTime))]),t._v(" "),a("td",{staticClass:"col"},[t._v(t._s(t._f("toHHMM")(t.formatData.period)))]),t._v(" "),a("td",{staticClass:"col"},[a("span",{staticClass:"cost"},[t._v(t._s(t.formatData.cost))]),t._v("元")])])]),t._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t.editStatus?[a("el-button",{on:{click:t.closeDialog}},[t._v("取 消")]),t._v(" "),a("el-button",{attrs:{disabled:t.loading,type:"primary"},on:{click:function(e){t.handleSubmit("form")}}},[t._v("保 存")])]:[a("el-button",{attrs:{type:"danger",plain:""},on:{click:function(e){t.editStatus=!0}}},[t._v("修 改")]),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:t.continueAdd}},[t._v("继续添加")])]],2)])],1)},staticRenderFns:[]};var b=a("VU/8")(_,g,!1,function(t){a("UwhC")},"data-v-35e5eccf",null).exports,y=window.innerHeight-210,w={props:{currentNav:{type:String,required:!0},path:{type:String,required:!0}},data:function(){return{tableData:[],pageSizes:[10,20,50,100],pageInfos:{size:20,current:1,count:0},tableHeight:y,isItemShow:!1,item:{},loading:!1}},computed:{isRecycle:function(){return"recycle"===this.path}},components:{Item:b},methods:{getList:function(t){var e=this;this.loading=!0;var a={pageSize:this.pageInfos.size,currentPage:this.pageInfos.current};this.isRecycle&&(a.status=1),f("List.html",a).then(function(t){e.tableData=t.result,e.pageInfos.count=t.count,e.loading=!1}).then(function(){e.loading=!1})},handleSizeChange:function(t){this.pageInfos.size=t,this.getList()},addLog:function(){this.item={},this.isItemShow=!0},handleEdit:function(t){this.item=t,this.isItemShow=!0},handleDelete:function(t){var e=this;this.$confirm("确定要删除该记录吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){e.changeLogStatus(t.id,1)}).catch(function(){})},handleRestore:function(t){var e=this;this.$confirm("确定要还原该记录吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){e.changeLogStatus(t.id,0)}).catch(function(){})},changeLogStatus:function(t,e){var a=this;f("ChangeStatus.html",{id:t,status:e}).then(function(t){a.$message({type:"success",message:t.msg}),a.getList()})},handleCompletelyDelete:function(t){var e=this;this.$confirm("此操作将永久删除该记录, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){e.completelyDelete(t.id)}).catch(function(){})},completelyDelete:function(t){var e=this;f("Delete.html",{id:t}).then(function(t){e.$message({type:"success",message:t.msg}),e.getList()})}},filters:{formatDate:function(t){return t.slice(0,10)},formatTime:function(t){return t.slice(10,16)},toHHMM:function(t){return Math.floor(t/60)+"时"+t%60+"分"},formatMoney:function(t){return t.toFixed(2)}},created:function(){this.getList()}},x={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"main"},[a("div",{staticClass:"main-head"},[a("el-breadcrumb",{attrs:{separator:"/"}},[a("el-breadcrumb-item",{attrs:{to:{path:"/"}}},[t._v("首页")]),t._v(" "),a("el-breadcrumb-item",[t._v(t._s(t.currentNav))])],1),t._v(" "),a("el-button",{staticClass:"add-button",attrs:{type:"primary",size:"small",icon:"el-icon-edit"},on:{click:t.addLog}},[t._v("\n      新增记录\n    ")])],1),t._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"table-list",staticStyle:{},attrs:{data:t.tableData,height:t.tableHeight}},[a("el-table-column",{attrs:{label:"日期",width:"180"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("i",{staticClass:"el-icon-date"}),t._v(" "),a("span",{staticStyle:{"margin-left":"10px"}},[t._v(t._s(t._f("formatDate")(e.row.startTime)))])]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"userName",label:"姓名",width:"120"}}),t._v(" "),a("el-table-column",{attrs:{label:"开井时间",width:"120"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n        "+t._s(t._f("formatTime")(e.row.startTime))+"\n      ")]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"关井时间",width:"120"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n        "+t._s(t._f("formatTime")(e.row.endTime))+"\n      ")]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"耗时",width:"140"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n        "+t._s(t._f("toHHMM")(e.row.period))+"\n      ")]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"费用",width:"140"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",{staticClass:"cost"},[t._v(t._s(t._f("formatMoney")(e.row.cost)))]),t._v("元\n      ")]}}])}),t._v(" "),t.isRecycle?a("el-table-column",{attrs:{label:"操作"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{attrs:{type:"text",size:"small"},on:{click:function(a){t.handleRestore(e.row)}}},[t._v("还原")]),t._v(" "),a("el-button",{staticClass:"red",attrs:{type:"text",size:"small"},on:{click:function(a){t.handleCompletelyDelete(e.row)}}},[t._v("彻底删除")])]}}])}):a("el-table-column",{attrs:{label:"操作"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{attrs:{type:"text",size:"small"},on:{click:function(a){t.handleEdit(e.row)}}},[t._v("修改")]),t._v(" "),a("el-button",{staticClass:"red",attrs:{type:"text",size:"small"},on:{click:function(a){t.handleDelete(e.row)}}},[t._v("删除")])]}}])})],1),t._v(" "),a("div",{staticClass:"main-foot"},[a("el-pagination",{staticClass:"pagination",attrs:{background:"",layout:"prev, pager, next, sizes, total",total:t.pageInfos.count,"page-sizes":[10,20,50,100],"page-size":t.pageInfos.size,"current-page":t.pageInfos.current},on:{"update:currentPage":function(e){t.$set(t.pageInfos,"current",e)},"size-change":t.handleSizeChange,"current-change":t.getList}})],1),t._v(" "),t.isItemShow?a("Item",{attrs:{item:t.item},on:{close:function(e){t.isItemShow=!1},refresh:t.getList}}):t._e()],1)},staticRenderFns:[]};var C=a("VU/8")(w,x,!1,function(t){a("KK7s")},"data-v-5db1c957",null).exports,S={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"content"},[a("div",{staticClass:"aside"},[a("h1",{staticClass:"title"},[t._v("\n      灌溉收费管理系统\n    ")]),t._v(" "),a("el-menu",{attrs:{"default-active":t.path},on:{select:t.handleSelect}},[a("el-menu-item",{attrs:{index:"list"}},[a("i",{staticClass:"el-icon-edit-outline"}),t._v(" "),a("span",{attrs:{slot:"title"},slot:"title"},[t._v("灌溉记录")])]),t._v(" "),a("el-menu-item",{attrs:{index:"statistics"}},[a("i",{staticClass:"el-icon-tickets"}),t._v(" "),a("span",{attrs:{slot:"title"},slot:"title"},[t._v("统计列表")])]),t._v(" "),a("el-menu-item",{attrs:{index:"recycle"}},[a("i",{staticClass:"el-icon-delete"}),t._v(" "),a("span",{attrs:{slot:"title"},slot:"title"},[t._v("回收站")])])],1)],1),t._v(" "),a("router-view",{key:t.path,attrs:{path:t.path,currentNav:t.currentNav}})],1)},staticRenderFns:[]};var k=a("VU/8")({name:"home",computed:{path:function(){return this.$route.path.replace("/","")||"list"},currentNav:function(){return"statistics"===this.path?"统计列表":"recycle"===this.path?"回收站":"灌溉记录"}},methods:{handleSelect:function(t){this.$router.push(t)}}},S,!1,function(t){a("sJ2G")},"data-v-575b0808",null).exports,T=void 0,D=window.innerHeight-210,M={props:{currentNav:{type:String,required:!0}},data:function(){return{tableData:[],summary:{count:0,period:0,cost:0},tableHeight:D,month:new Date,pickerOptions:{disabledDate:function(t){return t.getTime()>Date.now()}},expandButtonText:"全部展开",loading:!1}},methods:{getList:function(){var t=this;this.loading=!0;var e={timeStamp:this.month.getTime()};f("Statistics.html",e).then(function(e){t.tableData=e.result,t.summary=e.summary,t.loading=!1}).then(function(){t.loading=!1})},handleMonth:function(t){this.getList()},toggleExpansion:function(){var t=this;this.tableData.forEach(function(e){t.$refs.table.toggleRowExpansion(e)})},handleExpandChange:function(t,e){var a=this;clearTimeout(T),T=setTimeout(function(){a.changeExpandButtonText(e)},50)},changeExpandButtonText:function(t){this.expandButtonText=t.length?"全部折叠":"全部展开"},computedSummary:function(t){t.columns,t.data;return["","总计",this.summary.count,this.summary.period,this.summary.cost]},handleExport:function(){var t="/exportExcel/"+this.month.getTime();window.location=t}},filters:{toHHMM:function(t){return Math.floor(t/60)+"时"+t%60+"分"},formatDateTime:function(t){return t.slice(0,-3)},formatMoney:function(t){return t.toFixed(2)}},created:function(){this.getList()}},$={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"main"},[a("div",{staticClass:"main-head"},[a("el-breadcrumb",{attrs:{separator:"/"}},[a("el-breadcrumb-item",{attrs:{to:{path:"/"}}},[t._v("首页")]),t._v(" "),a("el-breadcrumb-item",[t._v(t._s(t.currentNav))])],1),t._v(" "),a("el-button",{staticClass:"add-button",attrs:{type:"success",size:"small"},on:{click:t.handleExport}},[t._v("\n      导出\n    ")])],1),t._v(" "),a("div",{staticClass:"panel"},[a("el-button",{on:{click:t.toggleExpansion}},[t._v(t._s(t.expandButtonText))]),t._v(" "),a("label",{staticClass:"filter-label"},[t._v("按月份筛选：")]),t._v(" "),a("el-date-picker",{staticStyle:{width:"120px"},attrs:{type:"month","picker-options":t.pickerOptions,editable:!1,clearable:!1,placeholder:"按月筛选"},on:{change:t.handleMonth},model:{value:t.month,callback:function(e){t.month=e},expression:"month"}})],1),t._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],ref:"table",staticClass:"table-list",staticStyle:{},attrs:{id:"table",data:t.tableData,height:t.tableHeight,"show-summary":"","header-row-class-name":"head-bg","summary-method":t.computedSummary},on:{"expand-change":t.handleExpandChange}},[a("el-table-column",{attrs:{type:"expand"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-table",{staticStyle:{width:"100%"},attrs:{border:"",data:e.row.children}},[a("el-table-column",{attrs:{type:"index",width:"50"}}),t._v(" "),a("el-table-column",{attrs:{label:"开井时间"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n              "+t._s(t._f("formatDateTime")(e.row.startTime))+"\n            ")]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"关井时间"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n              "+t._s(t._f("formatDateTime")(e.row.endTime))+"\n            ")]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"耗时"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n              "+t._s(t._f("toHHMM")(e.row.period))+"\n            ")]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"cost",label:"费用(元)"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n              "+t._s(t._f("formatMoney")(e.row.cost))+"\n            ")]}}])})],1)]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"userName",label:"姓名"}}),t._v(" "),a("el-table-column",{attrs:{prop:"count",label:"灌溉次数"}}),t._v(" "),a("el-table-column",{attrs:{prop:"period",label:"耗时"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n        "+t._s(t._f("toHHMM")(e.row.period))+"\n      ")]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"cost",label:"费用小计"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",{staticClass:"cost"},[t._v(t._s(t._f("formatMoney")(e.row.cost)))]),t._v("元\n      ")]}}])})],1)],1)},staticRenderFns:[]};var N=a("VU/8")(M,$,!1,function(t){a("cC/I"),a("hym7")},"data-v-bf39ec1a",null).exports,H={render:function(){var t=this.$createElement;return(this._self._c||t)("div",{staticClass:"list"})},staticRenderFns:[]};var I=a("VU/8")({data:function(){return{tableData:[]}}},H,!1,function(t){a("dnMy")},"data-v-551ddf7c",null).exports;n.default.use(l.a);var z=new l.a({routes:[{path:"/",component:k,children:[{path:"",component:C},{path:"list",name:"List",component:C},{path:"recycle",name:"Recycle",component:C},{path:"statistics",name:"Statistics",component:N}]},{path:"login",name:"Login",component:I}]});n.default.use(r.a),n.default.config.productionTip=!1,new n.default({el:"#app",router:z,components:{App:s},template:"<App/>"})},UwhC:function(t,e){},"cC/I":function(t,e){},dnMy:function(t,e){},hjMK:function(t,e){},hym7:function(t,e){},sJ2G:function(t,e){},tvR6:function(t,e){}},["NHnr"]);
//# sourceMappingURL=app.82435f57a700ed5da16c.js.map